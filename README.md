# PainlessGantt

[![Docker Hub](https://img.shields.io/docker/automated/manabedaiki/painless-gantt.svg)](https://hub.docker.com/r/manabedaiki/painless-gantt)

YAML フォーマットでガントチャートを作成しましょう。

[ihgs/yaml2gantt](https://github.com/ihgs/yaml2gantt) にインスパイア❤️されました。

![スクリーンショット](screenshot.png)

## 使い方

Docker 上で動かすことを前提としています。

```sh
make build run
```

👉 [`assets`](assets) ディレクトリに `ganttchart.xlsx` が作成されます。

## 使い方 (実践)

[`assets`](assets) ディレクトリの内容を参考に、あなたのプロジェクト固有の設定を作成してください。

- `project.yml`
- `template.xlsx` (そのままでも問題ありません)

Docker 上で実行します。

```sh
docker container run \
    --rm \
    -v /あなたのプロジェクト固有の設定:/data \
    manabedaiki/painless-gantt:latest \
        --project /data/project.yml \
        --template /data/template.xlsx \
        --output /data/ganttchart.xlsx
```

👉 `/あなたのプロジェクト固有の設定/ganttchart.xlsx` が作成されました！🎉👏

## ガントチャートの定義

ガントチャートの定義は YAML フォーマットで記述します。
日本の現場指向😨なので、設定ファイルは日本語です。

サンプルが [`assets/project.yml`](assets/project.yml) にあります。

```yaml
設定:
  祝日:
  - 2017/12/25
  - 2017/12/26
  - 2017/12/27
  - 2017/12/28
  - 2017/12/29
  - 2018/01/01
  - 2018/01/02
  - 2018/01/03
  - 2018/01/04
  - 2018/01/05

プロジェクト一覧:
- プロジェクト: プロジェクトA
  作業一覧:
  - 作業: 設計
    詳細:
    - 作業: 機能A
      予定: { 開始: 2017/10/01, 終了: 2017/10/30 }
      実績: { 開始: 2017/09/25, 終了: 2017/10/27 }
      状態: Completed
    - 作業: 機能B
      予定: { 開始: 2017/10/01, 終了: 2017/10/30 }
      実績: { 開始: 2017/10/06, 終了: 2017/10/24 }
      状態: Completed
    - 作業: 機能C
      予定: { 開始: 2017/10/01, 終了: 2017/10/30 }
  - 作業: 実装
    詳細:
    - 作業: 機能A
      予定: { 開始: 2017/11/01, 終了: 2017/11/30 }
    - 作業: 機能B
      予定: { 開始: 2017/11/20, 終了: 2017/12/15 }
    - 作業: 機能C
      予定: { 開始: 2017/12/01, 終了: 2017/12/22 }
  - 作業: 試験
    詳細:
    - 作業: 単体試験
      予定: { 開始: 2018/01/01, 終了: 2018/01/31 }
    - 作業: 結合試験
      予定: { 開始: 2018/02/01, 終了: 2018/02/28 }
    - 作業: 総合試験
      予定: { 開始: 2018/03/01, 終了: 2018/03/31 }
```

## テンプレート

`--template` コマンドライン引数で指定した Excel ファイルをベースにガントチャートを作成しています。
いくつかのルールを守ることで、ガントチャートの見た目をカスタマイズできます。

### シート名

`ガントチャート` という名前のシートが必要です。

### セル構造

`ガントチャート` シートの特定のセルのスタイルをコピーする作りになっています。

|   | A   | B   | C   | D   | E   | F   | G    | H    | I    | J    |
|---|-----|-----|-----|-----|-----|-----|------|------|------|------|
| 1 | (1) |     |     |     |     |     | (2)  |      |      |      |
| 2 |     |     |     |     |     |     | (3)  |      |      |      |
| 3 |     |     |     |     |     |     | (2)  |      |      |      |
| 4 |     |     |     |     |     |     | (2)  |      |      |      |
| 5 | (4) | (5) | (6) | (7) | (8) | (9) | (10) | (10) | (10) | (10) |

1. ガントチャートを作成した時刻 (`DateTime`) が設定されます。
2. カレンダーの日付 (`DateTime`) が設定されます。
3. 祝日 (`祝`) や休日 (`休`) が設定されます。
4. 各作業のタイトル (`作業`) が設定されます。
5. 各作業の予定開始日 (`予定.開始`) が設定されます。
6. 各作業の予定終了日 (`予定.終了`) が設定されます。
7. 各作業の実績開始日 (`実績.開始`) が設定されます。
8. 各作業の実績終了日 (`実績.終了`) が設定されます。
9. 各作業の状態 (`状態`) が設定されます。
10. ガントチャートの状態に応じたスタイルです。
    - G列：予定なし
    - H列：予定期間内
    - I列：予定期間内かつ実績期間内
    - J列：実績期間内
